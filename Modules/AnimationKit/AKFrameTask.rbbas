#tag ClassProtected Class AKFrameTaskInherits AKTask	#tag Method, Flags = &h0		Sub Constructor(TheItem As AKFrameTarget)		  me.item = theitem		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Perform(Final As Boolean = False)		  if me.item isa akframetarget then		  else		    return		  end		  		  dim frameDuration as double = (duration * 1000000) / (ubound(frames) + 1)		  		  if microseconds - pcurrentframestart >= frameduration then		    pcurrentframestart = microseconds		  else		    return		  end		  		  if currentframe >= ubound(frames) then		    if me.looping then		      currentframe = 0		    else		      pcomplete = true		      return		    end		  else		    currentframe = currentframe + 1		  end		  		  if me.item <> nil then		    dim k as akframetarget		    k = akframetarget(me.item)		    k.changeframe(currentframe,me.frames(currentframe))		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function HasCompleted() As Boolean		  return pComplete		End Function	#tag EndMethod	#tag Property, Flags = &h0		Frames() As Picture	#tag EndProperty	#tag Property, Flags = &h0		CurrentFrame As Integer	#tag EndProperty	#tag Property, Flags = &h0		Looping As Boolean = True	#tag EndProperty	#tag Property, Flags = &h21		Private pComplete As Boolean = False	#tag EndProperty	#tag Property, Flags = &h0		Duration As Double	#tag EndProperty	#tag Property, Flags = &h21		Private pCurrentFrameStart As Double	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="CurrentFrame"			Group="Behavior"			InitialValue="0"			Type="Integer"		#tag EndViewProperty		#tag ViewProperty			Name="Looping"			Group="Behavior"			InitialValue="True"			Type="Boolean"		#tag EndViewProperty		#tag ViewProperty			Name="Duration"			Group="Behavior"			InitialValue="0"			Type="Double"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass