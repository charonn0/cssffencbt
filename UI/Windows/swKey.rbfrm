#tag WindowBegin Window swKey   BackColor       =   16777215   Backdrop        =   ""   BalloonHelp     =   ""   CloseButton     =   "True"   Composite       =   "False"   Frame           =   8   FullScreen      =   "False"   HasBackColor    =   "False"   Height          =   90   ImplicitInstance=   "True"   LiveResize      =   "True"   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   "False"   MaxWidth        =   32000   MenuBar         =   326659859   MenuBarVisible  =   "True"   MinHeight       =   64   MinimizeButton  =   "True"   MinWidth        =   64   Placement       =   0   Resizeable      =   "False"   Title           =   "Choose a Password"   Visible         =   "True"   Width           =   300   Begin BevelButton bbBrowse      AcceptFocus     =   "False"      AutoDeactivate  =   "True"      Bevel           =   3      Bold            =   "False"      ButtonType      =   0      Caption         =   "Browse.."      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      ControlOrder    =   0      Enabled         =   "True"      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   "False"      Left            =   248      LockBottom      =   ""      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      MenuValue       =   0      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TextFont        =   "System"      TextSize        =   0      Top             =   101      Underline       =   "False"      Value           =   "False"      Visible         =   "False"      Width           =   60      BehaviorIndex   =   0   End   Begin StaticText stMimicPath      AutoDeactivate  =   "True"      Bold            =   ""      ControlOrder    =   1      DataField       =   ""      DataSource      =   ""      Enabled         =   "True"      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      Text            =   "Choose a file to mimic..."      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      Top             =   101      Underline       =   ""      Visible         =   "False"      Width           =   188      BehaviorIndex   =   1   End   Begin EditField edKey      AcceptTabs      =   "False"      Alignment       =   0      AutoDeactivate  =   "True"      BackColor       =   16777215      Bold            =   ""      Border          =   "True"      ControlOrder    =   2      DataField       =   ""      DataSource      =   ""      Enabled         =   "True"      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   60      LimitText       =   0      LockBottom      =   ""      LockLeft        =   ""      LockRight       =   ""      LockTop         =   "True"      Mask            =   ""      Multiline       =   ""      Password        =   "True"      ReadOnly        =   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   "True"      Styled          =   ""      TabIndex        =   2      TabPanelIndex   =   0      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      Top             =   13      Underline       =   ""      UseFocusRing    =   "True"      Visible         =   "True"      Width           =   197      BehaviorIndex   =   2   End   Begin EditField edConfirm      AcceptTabs      =   "False"      Alignment       =   0      AutoDeactivate  =   "True"      BackColor       =   16777215      Bold            =   ""      Border          =   "True"      ControlOrder    =   3      DataField       =   ""      DataSource      =   ""      Enabled         =   "True"      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   88      LimitText       =   0      LockBottom      =   ""      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Mask            =   ""      Multiline       =   ""      Password        =   "True"      ReadOnly        =   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   "True"      Styled          =   ""      TabIndex        =   3      TabPanelIndex   =   0      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      Top             =   43      Underline       =   ""      UseFocusRing    =   "True"      Visible         =   "False"      Width           =   220      BehaviorIndex   =   3   End   Begin StaticText stKey      AutoDeactivate  =   "True"      Bold            =   ""      ControlOrder    =   4      DataField       =   ""      DataSource      =   ""      Enabled         =   "True"      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockLeft        =   ""      LockRight       =   ""      LockTop         =   "True"      Multiline       =   ""      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      Text            =   "Key:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      Top             =   14      Underline       =   ""      Visible         =   "True"      Width           =   28      BehaviorIndex   =   4   End   Begin EditField edFileName      AcceptTabs      =   "False"      Alignment       =   0      AutoDeactivate  =   "True"      BackColor       =   16777215      Bold            =   ""      Border          =   "True"      ControlOrder    =   5      DataField       =   ""      DataSource      =   ""      Enabled         =   "True"      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LimitText       =   0      LockBottom      =   ""      LockLeft        =   "True"      LockRight       =   "True"      LockTop         =   ""      Mask            =   ""      Multiline       =   ""      Password        =   ""      ReadOnly        =   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   "True"      Styled          =   ""      TabIndex        =   5      TabPanelIndex   =   0      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      Top             =   103      Underline       =   ""      UseFocusRing    =   "True"      Visible         =   "False"      Width           =   260      BehaviorIndex   =   5   End   Begin PushButton bOk      AutoDeactivate  =   "True"      Bold            =   ""      Cancel          =   ""      Caption         =   "OK"      ControlOrder    =   6      Default         =   "True"      Enabled         =   "True"      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   200      LockBottom      =   "True"      LockLeft        =   ""      LockRight       =   "True"      LockTop         =   ""      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TextFont        =   "System"      TextSize        =   0      Top             =   50      Underline       =   ""      Visible         =   "True"      Width           =   80      BehaviorIndex   =   6   End   Begin PushButton bCancel      AutoDeactivate  =   "True"      Bold            =   ""      Cancel          =   "False"      Caption         =   "Cancel"      ControlOrder    =   7      Default         =   "False"      Enabled         =   "True"      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   108      LockBottom      =   "True"      LockLeft        =   ""      LockRight       =   "True"      LockTop         =   ""      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TextFont        =   "System"      TextSize        =   0      Top             =   50      Underline       =   ""      Visible         =   "True"      Width           =   80      BehaviorIndex   =   7   End   Begin CheckBox cbHide      AutoDeactivate  =   "True"      Bold            =   ""      Caption         =   "Hide"      ControlOrder    =   8      DataField       =   ""      DataSource      =   ""      Enabled         =   "True"      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   "True"      LockLeft        =   "True"      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   8      TabPanelIndex   =   0      TextFont        =   "System"      TextSize        =   0      Top             =   50      Underline       =   ""      Value           =   "True"      Visible         =   "True"      Width           =   58      BehaviorIndex   =   8   End   Begin StaticText stConfirm      AutoDeactivate  =   "True"      Bold            =   ""      ControlOrder    =   9      DataField       =   ""      DataSource      =   ""      Enabled         =   "True"      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockLeft        =   ""      LockRight       =   ""      LockTop         =   "True"      Multiline       =   ""      Scope           =   0      TabIndex        =   9      TabPanelIndex   =   0      Text            =   "Confirm:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      Top             =   44      Underline       =   ""      Visible         =   "False"      Width           =   56      BehaviorIndex   =   9   End   Begin DisclosureTriangle dtFileName      AcceptFocus     =   "False"      AutoDeactivate  =   "True"      ControlOrder    =   10      Enabled         =   "True"      Facing          =   0      Height          =   18      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   "False"      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   10      TabPanelIndex   =   0      Top             =   77      Value           =   "False"      Visible         =   "True"      Width           =   18      BehaviorIndex   =   10   End   Begin StaticText stFileName      AutoDeactivate  =   "True"      Bold            =   ""      ControlOrder    =   11      DataField       =   ""      DataSource      =   ""      Enabled         =   "True"      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   39      LockBottom      =   "False"      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   11      TabPanelIndex   =   0      Text            =   "File Name"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      Top             =   76      Underline       =   ""      Visible         =   "True"      Width           =   123      BehaviorIndex   =   11   End   Begin Line lSplit      BorderWidth     =   1      ControlOrder    =   12      Height          =   0.0      Index           =   -2147483648      InitialParent   =   ""      Left            =   108      LineColor       =   0      Scope           =   0      TabIndex        =   12      TabPanelIndex   =   0      Top             =   87      Visible         =   "True"      Width           =   2.0e+2      X1              =   108      X2              =   308      Y1              =   87      Y2              =   87      BehaviorIndex   =   12   End   Begin BevelButton bKey      AcceptFocus     =   "False"      AutoDeactivate  =   "True"      Bevel           =   0      Bold            =   "False"      ButtonType      =   0      Caption         =   ""      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      ControlOrder    =   13      Enabled         =   "True"      HasMenu         =   0      Height          =   21      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   "False"      Left            =   269      LockBottom      =   ""      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      MenuValue       =   0      Scope           =   0      TabIndex        =   13      TabPanelIndex   =   0      TextFont        =   "System"      TextSize        =   0      Top             =   13      Underline       =   "False"      Value           =   "False"      Visible         =   "True"      Width           =   19      BehaviorIndex   =   13   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  'If NOT Preferences.ConfirmKey AND DoingEncrypt Then		  'Self.Height = 110		  'Self.Width = 300		  'ElseIf Preferences.Overwrite AND NOT DoingEncrypt Then		  'Self.Height = 115		  'Self.Width = 328		  'ElseIf NOT DoingEncrypt Then		  'Self.Height = 90		  'Self.Width = 300		  'ElseIf Preferences.EnableMimics AND Preferences.AskMimic AND DoingEncrypt Then		  'Self.Height = 148		  'Self.Width = 328		  'ElseIf Preferences.EnableMimics AND NOT Preferences.AskMimic AND DoingEncrypt Then		  'Self.Height = 115		  'Self.Width = 328		  'Else		  'Self.Height = 115		  'Self.Width = 328		  'End If		  		  If NOT DoingEncrypt Then		    Self.Height = 90		    Self.Width = 300		  Else		    		    If (Preferences.EnableMimics AND Preferences.AskMimic) Then		      Self.Height = Self.Height + 33		    ElseIf NOT Preferences.Overwrite Then		      Self.Height = Self.Height + 33 		    Else		      Self.Height = 90		      Self.Width = 300		    End If		  End If		  If Preferences.ConfirmKey AND Self.Height <> 328 Then		    Self.Height = Self.Height + 25		    Self.Width =  328		  End If		  If CurrentEncryptionType = "" Then		    CurrentEncryptionType = Preferences.DefaultEncryptionType		  End If		  If Preferences.ShowPasswordStrength Then		    wPswdStrength.Show		  End If		End Sub	#tag EndEvent	#tag Event		Sub Close()		  wPswdStrength.Close		  If NOT closeNicely Then		    wMain.TransitionBack		  End If		End Sub	#tag EndEvent#tag MenuHandler		Function HelpVisitWebsite() As Boolean Handles HelpVisitWebsite.Action			ShowURL("http://www.fastforwardsw.com/products/bitclamp")		End Function#tag EndMenuHandler#tag MenuHandler		Function WindowMinimize() As Boolean Handles WindowMinimize.Action			Minimize		End Function#tag EndMenuHandler#tag MenuHandler		Function FileAboutBitClamp() As Boolean Handles FileAboutBitClamp.Action			wAbout.Show(true)		End Function#tag EndMenuHandler#tag MenuHandler		Function WindowBringAlltoFront() As Boolean Handles WindowBringAlltoFront.Action			#If TargetMacOS Then			CarbonBringAllWindowsToFront			#endif		End Function#tag EndMenuHandler#tag MenuHandler		Function HelpUserGuide() As Boolean Handles HelpUserGuide.Action			Dim ug As FolderItem = GetFolderItem(Preferences.UserGuidePath, FolderItem.PathTypeShell)						If NOT ug.Exists Then			dim r as NavigationDialogResultMBS						dim n as NavigationDialogMBS			dim o as NavigationDialogOptionsMBS						const kNavAllowPreviews             = &h00000040 // allow preview to show			const kNavSupportPackages           = &h00001000 // recognize file system packages, v2.0 or greater									o=new NavigationDialogOptionsMBS			o.Flags=kNavAllowPreviews+kNavSupportPackages			o.Message="Please locate the User Guide."						n=new NavigationDialogMBS			n.StartLocation=GetFolderItem("")			n.Options=o			n.ShowChooseFileDialog(nil)						r=n.Result			If r = NIL Then Return False			ug = r.File			Preferences.UserGuidePath = ug.ShellPath			End If						ug.Launch		End Function#tag EndMenuHandler	#tag Property, Flags = &h21		#tag Note			Set this to true if the window needs to be closed but not transitioned back a step.		#tag EndNote		Private closeNicely As Boolean = False	#tag EndProperty#tag EndWindowCode#tag Events bbBrowse	#tag Event		Sub Action()		  Dim temp as FolderItem		  temp = GetOpenFolderItem("")		  If temp <> Nil Then		    currentMimic = temp		    If Len(currentMimic.ShellPath.ReplaceAll("\", "") ) > 26 Then		      stMimicPath.TextAlign = 2		      stMimicPath.Text = "..." + Right(currentMimic.ShellPath.ReplaceAll("\", "") , 23)		    Else		      stMimicPath.TextAlign = 1		      stMimicPath.text = currentMimic.ShellPath.ReplaceAll("\", "")		    End If		    stMimicPath.HelpTag = currentMimic.ShellPath.ReplaceAll("\", "")		  End If		End Sub	#tag EndEvent#tag EndEvents#tag Events edKey	#tag Event		Sub TextChange()		  If Preferences.ShowPasswordStrength Then		    wPswdStrength.Update(Me.Text)		  End If		  		End Sub	#tag EndEvent	#tag Event		Sub Open()		  Me.SetFocus		  If Preferences.ConfirmKey  AND DoingEncrypt Then		    Me.Left = 88		  End If		End Sub	#tag EndEvent#tag EndEvents#tag Events edConfirm	#tag Event		Sub Open()		  If Preferences.ConfirmKey  AND DoingEncrypt Then		    Me.Visible = True		  End If		End Sub	#tag EndEvent#tag EndEvents#tag Events stKey	#tag Event		Sub Open()		  If Preferences.ConfirmKey  AND DoingEncrypt Then		    Me.Left = 48		  End If		End Sub	#tag EndEvent#tag EndEvents#tag Events edFileName	#tag Event		Sub Open()		  Me.Text = Preferences.DefaultFileName + "." + Preferences.DefaultFileExtension		End Sub	#tag EndEvent	#tag Event		Sub TextChange()		  If Me.Text <> "" Then		    CurrentFileName = Me.Text		  Else		    CurrentFileName = Preferences.DefaultFileName + "." + Preferences.DefaultFileExtension		  End If		End Sub	#tag EndEvent#tag EndEvents#tag Events bOk	#tag Event		Sub Action()		   #pragma DisableBackgroundTasks		  //Check there is a key.		  If currentMimic = Nil AND Preferences.EnableMimics AND Preferences.AskMimic AND DoingEncrypt Then		    MsgBox "Please choose a file to mimic."		    Return		  End If		  If len(edKey.text) > 0 Then		    closeNicely = True		    //If we are confirming then is it the same		    If Preferences.ConfirmKey AND edKey.Text <> edConfirm.Text AND DoingEncrypt Then		      MsgBox "The text in the confirmation field did not match that of the key field. Please type a matching password."		      Return		    End If		    		    Dim targetfile as FolderItem = GetFolderItem(Preferences.DestinationFolder.ShellPath + "/" + CurrentFileName, folderitem.pathtypeshell)		    		    //Check for duplicates, if they are there then rename with numbers.		    Dim count as integer = 2		    While targetfile.Exists		      targetfile = GetFolderItem(Preferences.DestinationFolder.ShellPath + "/" + Preferences.DefaultFileName + str(count) + "." + Preferences.DefaultFileExtension, folderitem.pathtypeshell)		      count = count + 1		    Wend 		    		    If DoingEncrypt = True then		      //EncryptFile		      #If TargetMacOS Then		        If Preferences.GrowlEnabled = true then		          PostGrowl("Encryption Started")		        End If		      #endif		      wMain.bEncrypt.Default = False		      		      enc = NEW BCEncryptor		      		      If NOT Preferences.Overwrite Then		        enc.Encrypt(Items(), targetfile, CurrentEncryptionType, edKey.text, wMain.pbProgress, wMain.stReports)		      Else		        enc.Encrypt(Items(), Items(0), CurrentEncryptionType, edKey.text, wMain.pbProgress, wMain.stReports)		      End If		      		    Else		      //DecryptFile		      //check hash		      Dim check as new SHA_512		      check.Update(edKey.Text)		      		      If Checker.q <> check.Final then		        Beep		        MsgBox("Incorrect Key.")		        wMain.ResetWindow		        Close		      Else		        #If TargetMacOS Then		          If Preferences.GrowlEnabled = true then		            PostGrowl("Decryption Started")		          End If		        #endif		        wMain.bEncrypt.Default = False		        		        enc = NEW BCEncryptor		        If NOT Preferences.Overwrite Then		          enc.Decrypt(Items(0), Preferences.DestinationFolder, Checker.EncryptionType, edKey.text, wMain.pbProgress, wMain.stReports)		        Else		          enc.Decrypt(Items(0), Items(0).Parent, Checker.EncryptionType, edKey.text, wMain.pbProgress, wMain.stReports)		        End If		        		      End If		    End If		    Close		  Else		    MsgBox "Please supply a key of at least one character in length. We recommend using a key of above 6 characters in length."		  End If		End Sub	#tag EndEvent#tag EndEvents#tag Events bCancel	#tag Event		Sub Action()		  If DoingEncrypt Then		    wMain.TransitionBack		  Else		    wMain.ResetWindow		  End If		  closeNicely = True		  Close		End Sub	#tag EndEvent#tag EndEvents#tag Events cbHide	#tag Event		Sub Action()		  If me.Value = True then 		    edKey.Password = True		    edConfirm.Password = True		  Else		    edKey.Password = False		    edConfirm.Password = False		  End If		End Sub	#tag EndEvent#tag EndEvents#tag Events stConfirm	#tag Event		Sub Open()		  If Preferences.ConfirmKey  AND DoingEncrypt Then		    Me.Visible = True		  End If		End Sub	#tag EndEvent#tag EndEvents#tag Events dtFileName	#tag Event		Sub Open()		  If NOT DoingEncrypt OR Preferences.Overwrite Then 		    Me.Visible = False		  ElseIf NOT Preferences.ConfirmKey Then		    Me.Top = 43		  End If		  		  If Preferences.EnableMimics AND Preferences.AskMimic AND DoingEncrypt Then		    Me.Visible = True		  End If		End Sub	#tag EndEvent	#tag Event		Sub Action()		  if not me.value then		    self.animate createrect(self.top,self.left,self.height - 30,self.width),0.2		    edFileName.Visible = False		    stMimicPath.Visible = False		    bbBrowse.Visible = False		  else		    self.animate createrect(self.top,self.left,self.height + 30,self.width),0.2		    If NOT Preferences.EnableMimics Then		      edFileName.Visible = True		    Else		      stMimicPath.Visible = True		      bbBrowse.Visible = True		    End If		  end		End Sub	#tag EndEvent#tag EndEvents#tag Events stFileName	#tag Event		Sub Open()		  If NOT DoingEncrypt OR Preferences.Overwrite Then		    Me.Visible = False		  ElseIf NOT Preferences.ConfirmKey Then		    Me.Top = 42		  End If		  		  If Preferences.EnableMimics AND Preferences.AskMimic AND DoingEncrypt Then		    Me.Text = "File Mimicking"		    lSplit.X1 = 140		    Me.Visible = True		  End If		End Sub	#tag EndEvent	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  dtFileName.Value = NOT dtFileName.Value		End Function	#tag EndEvent#tag EndEvents#tag Events lSplit	#tag Event		Sub Open()		  If NOT DoingEncrypt  OR  Preferences.Overwrite Then		    Me.Visible = False		  ElseIf NOT Preferences.ConfirmKey Then		    Me.Y1 = 53		    Me.Y2 = 53		    Me.X2 = 280		  End If		  		  If Preferences.EnableMimics AND Preferences.AskMimic AND DoingEncrypt Then		    Me.Visible = True		  End If		End Sub	#tag EndEvent#tag EndEvents#tag Events bKey	#tag Event		Sub Open()		  Me.Icon = key		  Me.Left = edKey.left + 209		End Sub	#tag EndEvent	#tag Event		Sub Action()		  wPasswordGenerator.Show		End Sub	#tag EndEvent#tag EndEvents