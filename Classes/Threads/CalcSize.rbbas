#tag ClassProtected Class CalcSizeInherits Thread	#tag Event		Sub Run()		  //finds the size of the items, and produces a nicely formatted string, instead of		  // something like 3.58472238e+7		  		  dim nSize As double		  nSize=f.length		  If f.Directory = true then		    DIm dir as New shell, result as string		    dir.execute("du -s " + f.ShellPath)		    result = dir.Result		    Result = Left(Result, Result.InStr("/") - 2)		    nSize = val(result) * 512		  End If		  		  		  if nSize<1024 then		    Returned = str(nSize)+" Bytes"		  else		    nSize=nSize/1024		    if nSize<1024 then		      Returned = format(nSize,"###0.00")+" KB"		    else		      nSize=nSize/1024		      if nSize<1024 then		        Returned = format(nSize,"###0.00")+" MB"		      else		        nSize=nSize/1024		        if nSize<1024 then		          If TrialMode = True Then		            MsgBox "The trial version of BitClamp only allows files of under 1GB to be encrypted or decrypted. Please purchase BitClamp to remove this restriction."		            wMain.ResetWindow		          End If		          Returned = Format(nSize,"###0.00")+" GB"		        else		          nSize=nSize/1024		          Returned = Format(nSize,"#######0.00")+" TB"		        end if		      end if		    end if		  end if		  		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Function Calculate(f as FolderItem) As String		  Me.f = f		  Me.Run		  Return Me.Returned		End Function	#tag EndMethod	#tag Property, Flags = &h0		f As FolderItem	#tag EndProperty	#tag Property, Flags = &h0		Returned As String	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Thread"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InheritedFrom="Thread"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Thread"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InheritedFrom="Thread"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InheritedFrom="Thread"		#tag EndViewProperty		#tag ViewProperty			Name="Priority"			Visible=true			Group="Behavior"			InitialValue="5"			Type="Integer"			InheritedFrom="Thread"		#tag EndViewProperty		#tag ViewProperty			Name="StackSize"			Visible=true			Group="Behavior"			InitialValue="0"			Type="Integer"			InheritedFrom="Thread"		#tag EndViewProperty		#tag ViewProperty			Name="Returned"			Group="Behavior"			Type="String"			EditorType="MultiLineEditor"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass